USE [ClinicDB]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

DROP PROCEDURE IF EXISTS [dbo].[sp_CreateDrug]
GO

CREATE PROCEDURE [dbo].[sp_CreateDrug]
	@DrugName nvarchar(100)
    
AS
BEGIN TRY
	SET NOCOUNT ON;

	INSERT INTO [dbo].[Drugs] (DrugName)
    VALUES (@DrugName)

	RETURN @@IDENTITY
END TRY
BEGIN CATCH
	RETURN -1
END CATCH
GO

GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

DROP PROCEDURE IF EXISTS [dbo].[sp_DeleteDrug]
GO

CREATE PROCEDURE [dbo].[sp_DeleteDrug]
	@Id int
AS
BEGIN TRY
	SET NOCOUNT ON;
	
	DELETE FROM Drugs WHERE Id = @Id

	RETURN @@ROWCOUNT
END TRY
BEGIN CATCH
	RETURN -1
END CATCH
GO


GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

DROP PROCEDURE IF EXISTS [dbo].[sp_GetAllDrugs]
GO

CREATE PROCEDURE [dbo].[sp_GetAllDrugs] AS
BEGIN TRY
	SET NOCOUNT ON;

	SELECT * FROM [dbo].[Drugs]

	RETURN 0
END TRY
BEGIN CATCH
	RETURN -1
END CATCH
GO
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

DROP PROCEDURE IF EXISTS [dbo].[sp_GetDrugById]
GO

CREATE PROCEDURE [dbo].[sp_GetDrugById]
	@Id int
AS
BEGIN TRY
	SET NOCOUNT ON;

	SELECT * FROM [dbo].Drugs WHERE Id = @Id

	RETURN 0
END TRY
BEGIN CATCH
	RETURN -1
END CATCH
GO
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

DROP PROCEDURE IF EXISTS [dbo].[sp_UpdateDrug]
GO

CREATE PROCEDURE [dbo].[sp_UpdateDrug]
	@Id int,
    @DrugName nvarchar(100)
	
AS

IF NOT EXISTS (SELECT 1 FROM Drugs WHERE Id=@Id)
BEGIN
	RETURN -1
END

BEGIN TRY
	SET NOCOUNT ON;

    UPDATE [dbo].[Drugs]
		SET	[DrugName] = @DrugName
		WHERE Id = @Id

	RETURN @@ROWCOUNT
END TRY
BEGIN CATCH
	RETURN -1
END CATCH
GO


